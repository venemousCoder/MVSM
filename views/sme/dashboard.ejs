<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Dashboard</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
      <div class="btn-group me-2">
        <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
        <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
      </div>
    </div>
  </div>
  
  <!-- Quick Stats -->
  <div class="row mb-4">
      <div class="col-md-4">
          <div class="card text-white bg-primary mb-3">
              <div class="card-header">Total Orders</div>
              <div class="card-body">
                  <h5 class="card-title"><%= stats.totalOrders %></h5>
                  <p class="card-text">Total orders across all businesses.</p>
              </div>
          </div>
      </div>
      <div class="col-md-4">
          <div class="card text-white bg-success mb-3">
              <div class="card-header">Total Revenue</div>
              <div class="card-body">
                  <h5 class="card-title">$<%= stats.totalRevenue.toLocaleString() %></h5>
                  <p class="card-text">Total revenue from completed orders.</p>
              </div>
          </div>
      </div>
      <div class="col-md-4">
          <div class="card text-white bg-warning mb-3">
              <div class="card-header">Pending Requests</div>
              <div class="card-body">
                  <h5 class="card-title"><%= stats.pendingRequests %></h5>
                  <p class="card-text">Orders currently pending or processing.</p>
              </div>
          </div>
      </div>
  </div>
  
  <!-- Businesses Section -->
  <div class="d-flex justify-content-between align-items-center mb-3">
      <h2>My Businesses</h2>
      <a href="/sme/business/create" class="btn btn-primary">
          <i class="fas fa-plus"></i> Add New Business
      </a>
  </div>
  
  <% if (businesses && businesses.length > 0) { %>
      <div class="row row-cols-1 row-cols-md-3 g-4">
          <% businesses.forEach(function(business) { %>
              <div class="col">
                  <div class="card h-100">
                      <div class="card-body">
                          <h5 class="card-title"><%= business.name %></h5>
                          <h6 class="card-subtitle mb-2 text-muted"><%= business.type.charAt(0).toUpperCase() + business.type.slice(1) %> - <%= business.category %></h6>
                          <p class="card-text"><%= business.description.substring(0, 100) %>...</p>
                          <p class="card-text"><small class="text-muted"><%= business.address %></small></p>
                      </div>
                      <div class="card-footer bg-transparent border-top-0">
                          <a href="/sme/business/<%= business._id %>" class="btn btn-outline-primary w-100">Manage</a>
                      </div>
                  </div>
              </div>
          <% }); %>
      </div>
  <% } else { %>
      <div class="alert alert-info" role="alert">
          You haven't added any businesses yet. Click the button above to get started!
      </div>
  <% } %>
  
  <!-- Recent Activity -->
  <div class="d-flex justify-content-between align-items-center mt-5 mb-3">
    <h2>Recent Activity</h2>
    <a href="/sme/activities" class="btn btn-outline-primary btn-sm">View All</a>
  </div>
  <div class="table-responsive">
      <table class="table table-striped table-sm">
        <thead>
          <tr>
            <th scope="col">Date</th>
            <th scope="col">Action</th>
            <th scope="col">Business</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
        <tbody>
          <% if (typeof activities !== 'undefined' && activities.length > 0) { %>
            <% activities.forEach(function(activity) { %>
              <tr>
                <td><%= new Date(activity.createdAt).toLocaleDateString() %> <%= new Date(activity.createdAt).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %></td>
                <td>
                    <%= activity.action %>
                    <br>
                    <small class="text-muted"><%= activity.details %></small>
                </td>
                <td>
                    <% if (activity.business) { %>
                        <a href="/sme/business/<%= activity.business._id %>"><%= activity.business.name %></a>
                    <% } else { %>
                        <span class="text-muted">Unknown</span>
                    <% } %>
                </td>
                <td>
                    <% if (activity.status === 'completed') { %>
                        <span class="badge bg-success">Completed</span>
                    <% } else if (activity.status === 'pending') { %>
                        <span class="badge bg-warning text-dark">Pending</span>
                    <% } else if (activity.status === 'in-progress') { %>
                        <span class="badge bg-info text-dark">In Progress</span>
                    <% } else if (activity.status === 'shipped') { %>
                        <span class="badge bg-primary">Shipped</span>
                    <% } else { %>
                        <span class="badge bg-secondary"><%= activity.status %></span>
                    <% } %>
                </td>
              </tr>
            <% }); %>
          <% } else { %>
            <tr>
              <td colspan="4" class="text-center">No recent activity found.</td>
            </tr>
          <% } %>
        </tbody>
      </table>
  </div>
