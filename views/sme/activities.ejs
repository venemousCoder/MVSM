<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">Recent Activities</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a href="/sme/dashboard" class="btn btn-sm btn-outline-secondary">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
    </div>
</div>

<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">Action</th>
                  <th scope="col">Business</th>
                  <th scope="col">Status</th>
                </tr>
              </thead>
              <tbody>
                <% if (typeof activities !== 'undefined' && activities.length > 0) { %>
                  <% activities.forEach(function(activity) { %>
                    <tr>
                      <td>
                          <%= new Date(activity.createdAt).toLocaleDateString() %> 
                          <small class="text-muted"><%= new Date(activity.createdAt).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %></small>
                      </td>
                      <td>
                          <strong><%= activity.action %></strong>
                          <br>
                          <small class="text-muted"><%= activity.details %></small>
                      </td>
                      <td>
                          <% if (activity.business) { %>
                              <a href="/sme/business/<%= activity.business._id %>"><%= activity.business.name %></a>
                          <% } else { %>
                              <span class="text-muted">Unknown</span>
                          <% } %>
                      </td>
                      <td>
                          <% if (activity.status === 'completed') { %>
                              <span class="badge bg-success">Completed</span>
                          <% } else if (activity.status === 'pending') { %>
                              <span class="badge bg-warning text-dark">Pending</span>
                          <% } else if (activity.status === 'in-progress') { %>
                              <span class="badge bg-info text-dark">In Progress</span>
                          <% } else if (activity.status === 'shipped') { %>
                              <span class="badge bg-primary">Shipped</span>
                          <% } else { %>
                              <span class="badge bg-secondary"><%= activity.status %></span>
                          <% } %>
                      </td>
                    </tr>
                  <% }); %>
                <% } else { %>
                  <tr>
                    <td colspan="4" class="text-center py-4">
                        <i class="fas fa-history fa-2x text-muted mb-3"></i>
                        <p class="text-muted">No recent activity found.</p>
                    </td>
                  </tr>
                <% } %>
              </tbody>
            </table>
        </div>
    </div>
</div>
